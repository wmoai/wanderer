<script src="/socket.io/socket.io.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script>
  $(function() {
    var map;
    var socket = io('http://localhost');
    socket.on('news', function (data) {
      socket.emit('field');
    });
    socket.on('field', function(data) {
      var canvas = $('#field');
      var cc = canvas[0].getContext('2d')
      var cellSize = 10;
      cc.clearRect(0,0,canvas.width(),canvas.height());

      data.field.map(function(cell) {
        switch (cell.height) {
          case 1:
          cc.fillStyle = 'green';
          break;
          case 2:
          cc.fillStyle = 'darkslategray';
          break;
        }
        if (cell.loc[0] == data.center[0] && cell.loc[1] == data.center[1]) {
          cc.fillStyle = 'blue';
        }
        cc.fillRect(
        (cell.loc[0] - data.center[0] + data.range + 1)*cellSize,
        (cell.loc[1] - data.center[1] + data.range + 1)*cellSize,
        cellSize,
        cellSize);

      });
    });
    socket.on('event', function(data) {
      $('#console').html(data.msg);
    });

    $('html').on('keyup', function(e) {
      switch(e.keyCode) {
        case 37:
        socket.emit('move w');
        break;
        case 38:
        socket.emit('move n');
        break;
        case 39:
        socket.emit('move e');
        break;
        case 40:
        socket.emit('move s');
        break;
      }
    });
    $('#console').on('click', function(e) {
      console.log(e.offsetY);
    });
    
  });
</script>

<canvas id="field"></canvas>
<div id="console">move</div>
